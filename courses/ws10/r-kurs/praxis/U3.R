#Lösung des dritten Übungsblattes
#Autoren: Bernd Klaus und Verena Zuber
#25 Oktober 2010
########################################################################

########################################################################
########################################################################
########################################################################
########################################################################
#Aufgabe 1
########################################################################
########################################################################

#a
########################################################################

data<-read.csv(file="Daten/oecdM", header=TRUE, na.strings="NA")

#data<-read.csv(file="Daten/oecdM", header=TRUE, encoding = "UTF-8") 
#Bei Windows muss die Kodierung "UTF-8" erzwungen werden, um die Umlaute richtig 
#einzulesen 

attach(data)
head(data)
names(data)

#b
########################################################################

sapply(data[,-17], mean, na.rm=TRUE)
sapply(data[,-17], var, na.rm=TRUE)

#c
########################################################################

 "Niederlande" %in% row.names(data)
 "China" %in% row.names(data)

#d
########################################################################

Alkohol[which(Alkohol==max(Alkohol, na.rm=TRUE))]
row.names(data)[which(Alkohol==max(Alkohol, na.rm=TRUE))]

#bzw.

row.names(data)[which.max(Alkohol)]

#e
########################################################################

Säuglsterblichkeit[which(Säuglsterblichkeit==min(Säuglsterblichkeit, na.rm=TRUE))]
row.names(data)[which(Säuglsterblichkeit==min(Säuglsterblichkeit, na.rm=TRUE))]

#f
########################################################################

Bewegung[which(Bewegung<mean(Bewegung, na.rm=TRUE))]
row.names(data)[which(Bewegung<mean(Bewegung, na.rm=TRUE))]



########################################################################
########################################################################
#Aufgabe 2
########################################################################
########################################################################


#h
########################################################################


freq <- table(data$Geo)
pie(freq, col = c("green", "blue"))

#i
########################################################################

stripchart(data$Lesen~data$Geo, vertical = TRUE)


########################################################################
########################################################################
#Aufgabe 3
########################################################################
########################################################################

#a
########################################################################

boxplot(data$Bildung)


#b
########################################################################

qua <- quantile(data$Bildung, prob = c(0.25,0.5,0.75,0.85,0.95,1.00))


#c
########################################################################

plot(sort(data$Bildung), type = "l")


#d
########################################################################

#Für Werte, die größer als das 75% Quantil sind, steigt die Kurve offensichtlich stark an.

#e
########################################################################

sep  <- qua[3]

row.names(data)[which(data$Bildung > sep)]




########################################################################
########################################################################
#Aufgabe 3
########################################################################
########################################################################

#a
########################################################################

kanzler<-read.csv(file="Daten/kanzler.csv", header=TRUE, na.strings="NA")
dim(kanzler)
head(kanzler)




plot(kanzler[,1], type="l", col="orange", xlab="[Woche] seit Oktober 2009", ylab="Google-Abfrage", ylim=c(0,100))


#b
########################################################################

lines(kanzler[,2],  col="blue")



#c
########################################################################

legend("topright", legend=c("Merkel", "zu Guttenberg"), col=c("orange", "blue"), lty=1)

